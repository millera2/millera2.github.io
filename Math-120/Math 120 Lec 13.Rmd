---
title: "Math 120 Week 11"
author: "Ali Miller"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 3
    code_folding: show
    theme: yeti
    df_print: paged
  
  
---

```{r setup, include=FALSE}

#---------- RSTUDIO STARTER V 2.0  --------------#
#                    -Prepared with care by  AM ;D
                
                                                                          
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE)      
library(tidyverse)                
library(ggthemes)                    

theme_set(theme_tufte() +                                     
  theme(text=element_text(family="sans")))  

studentSurvey <- read_csv("Student Data.csv")
deathPenaltyData <- read_csv("death penalty data.csv")
housingData <- read_csv("../Data/House-Sales.csv")
#------------------------------------------------#
```




# Monday Nov 2

## Hypothesis Tests (Ctd)

Let's do one.  

**Ex**  In our class data, we found that 28 out of 42 of you had "brown hair".  Does this provide evidence that more than half of all DU students have brown hair?

Perform an appropriate hyp test with alpha = .05 significance.   

```{r}
28/42
```

1) Hypotheses.  Our claim:  more than half of DU studnets have brown hair.  This is the "alternate hypothesis", Ha. 

WARNING:  EVERY hypothesis has to be a mathemetical statement about a population parameter.   Here:  we're talking about "p", the population proportion of students with brown hair.

Ha: p > .5

Of course, we can't just assume we're correct.  Instead, we must assume the "null hypothesis":

H0: p = .5

Note:  the H0 must always be a statement of equality about a population parameter.  


H0: p = .5
Ha: p > .5



2) Test statistic.   The test stat is just the z-score for our sample result!

    z = (obs - exp)/stdev
    
      = (phat - p)/sqrt(p*(1-p)/n)
      
Here, phat is our sample prop, and p is the pop prop from the null hyp!!!



```{r}
(28/42 - .5)/sqrt(.5*(1-.5)/42)
```

Here, our test stat:  z = 2.16


3) p-value.  The "p-value" is the probability of observing a sample result as exteme as the one we got, assuming H0 is true.


Visually:  p = tail area outside our result.

Look up in table:

```{r}
1-0.9850
```

Here, p = 0.015.  

4)  We need to make a decision:  is our p-value "small enough"?  If our sample result is very unlikely (small p-val), then the assumptions we made to compute it must be wrong. We assumed H0!

This "cutoff" for "small enough" is called the "significance level".  We can choose our own sig level, alpha.  Here, we're using alpha = .05, a common value in the literature (but totally arbitrary).  

Here, since our p-value < alpha  (.015 < .05), it makes us suspect that H0 is wrong, so we REJECT Ho.  Thus, we've found strong evidence to support the Ha:  more than 50% of DU students have brown hair.

Yay!  We're happy, because we've found support for our claim!  There is "statistically siginficant" evidence to support our assertion that more than 50% of students have brown hair.



** Ex**  In our class, 12 out of 42 students are juniors.  Does this support the claim that "more than a quarter of 120 students are juniors"?  
1) Hyp

Ho: p = .25
Ha: p > .25

2) Test stat

    z = (12/42 - .25)/sqrt(.25*(1-.25)/42)


```{r}
(12/42 - .25)/sqrt(.25*(1-.25)/42)
```

3) p-val

    p = P(Z>.53)
    
```{r}
1-0.7019 
```

Here:  p = .2981.


4)  This is a large p-val:  p > .05.  In other words, our sample data and the H0 seem to be in agreement.  We do NOT have enough evidence to reject H0.  Sad face!  Our claim that "more than a quarter of 120 studens are juniors" was not supported.  



# Friday Nov 6

## Practice Problem:  CI

**Ex** In a random sample of 100 DU students, 12 students had gone waterskiing.  

Estimate the proportion of all DU students who've gone waterskiing with 92% confidence.

**Thoughts**

The thing we want to estimate is the PROPORTION, p.

Our sample data:  phat = 12/100, n = 100.

**Q**:  Is out sample size big enough?

Need:  phat*n and (1-phat)*n both need to be bigger than 10.

```{r}
100*(12/100)
```

```{r}
100*(1-12/100)
```

Yes!  Sample size is big enough!


Middle 92% -> 4% in the tails.  Look up zstar.

Here:  zstar = 1.75.

Formula:

     phat +/- zstar * sqrt( phat*(1-phat)/n )
     
     12/100 +/- 1.75*sqrt(12/100*(1-12/100)/100)    
     
```{r}
12/100 - 1.75*sqrt(12/100*(1-12/100)/100)
```
  
```{r}
12/100 + 1.75*sqrt(12/100*(1-12/100)/100)

```
  
We are 92% confident that the true proportion of DU students who've gone waterskiing is between 6.3% and 17.7%.



**Ex**  What's the MOE in the above CI?

Answer:  after +/-

```{r}
1.75*sqrt(12/100*(1-12/100)/100)
```


**Ex**

If we wanted to conduct a future study to estimate the proportion with MOE no greater than 3%, how large would our sample size have to be?  Still using 92% confidence level.

Recall:

     n = phat*(1-phat)*(zstar/MOE)^2
       = (12/100)*(1-12/100)*(1.75/.03)^2
     
```{r}
(12/100)*(1-12/100)*(1.75/.03)^2
```
     
We'd need at least 360 people in our sample.




**Ex**  In a sample of 200 DU studets, 79 of them enjoyed eating grapefruit.

Does this provide statistically significant evidence that fewer than half of students enjoy grapefruit?  Conduct an appropriate hyp test with alpha = .05.

1) Hypotheses

H0:  p = .5
Ha:  p < .5


2) Test stat

Recall, test stat is just a z-score:


    z = (obs - exp)/stdev
      = (79/200 - .5)/sqrt(.5*(1-.5)/200)


```{r}
(79/200 - .5)/sqrt(.5*(1-.5)/200)
```

Here, our test stat:  z = -2.97.



3) p-value.

Recall:  the p-value is the probability of observing a sample result that's as extreme the one we got, GIVEN THAT H0 IS TRUE.

Ie, find P(Z<-2.97)

Look up on the table:  p-val = .0015


4) Conclusion

Here, p<alpha.   .0015 < .05.  So, we reject H0.  Thus, we've found strong evidence to support the Ha:  fewer than half of DU students have gone waterskiing.


Yay!


## Two-tail test

The test we just did is a "left tail test".  

In a left tail test, the Ha has "<", thus the p-val is the area of the left tail.

On monday, we did "right tail tests".  In a right tail test, the alternate hypotheis is "bigger than".  


What if we want to test "not equal"

Ha:   !=

Since we're interested in BOTH small and large results, we need the tail area on BOTH SIDES.


Problem:  we only have one test stat!  Either on the left or the right.

Answer:  no prob, the normal dist is symmetric!

Thus, for a 2-tail test, you must always DOUBLE the tail area!


**Ex**  In Prof Miller's 2016 Math 120 course,  16 of 24 students were female.

Does this support the claim that the proportion of students at DU who are women differs from 50%?

1) Hyps

H0: p = .5
Ha: p != .5   (not equals)


2) test stat

```{r}
(16/24 - .5)/sqrt(.5*(1-.5)/24)
```

3)  p-val

tail area:

```{r}
1-0.9484
```


p-value:  2*tail area:

```{r}
2.*.0516
```


4)  Since p-val > .05, we fail to reject the H0.  There is not strong evidence that the proportion of female students differs from 50%.


Next time:  failure modes for hyp test.






# Monday Nov 9

## Inference for Quantitative Data (Ch 7)

So far, all of our inference has been about categorical data.  Ie, we've performing inference on **p**, the population proportion!

Now, let's do the same things for quantitative data.  Ie, we'll be performing inference on **mu**, the population mean.

Recall, there are two major types of statistical inference:

 - CIs are used to **estimate** population parameters (p, and mu)
 - Hyp tests are use to investigate a claim/answer a question about a population parameter (p, and mu).
 
 
The only reason this is possible is because of the CLT: as long our sample size is "large enough", then the sample statistics we collect follow a normal distribution.


For proportions (phat):  if np>10 and n(1-p)>10, then phat follows a normal dist with 

- mean = p
- stdev = sqrt(p*(1-p)/n)



For means (xbar):  if n > 30, then xbar follows a normal dist with

- mean = mu (population mean)
- stdev = sigma/sqrt(n)   (sigma is the population stdev).

The above gives us everything we need to do inference with means.

Ex)  Mean height for women in the US is 64" with std 2.4".  If we take sample of 40 women, what's the probability that their average height is greater than 64.3"?

Since n>30, we know xbar follows a normal dist.

Q:  Compute P( xbar >64.3 )

Find z-score:

    z = (obs - exp)/stdev
      = (64.3 - 64)/(2.4/sqrt(40))
      
      
```{r}
 (64.3 - 64)/(2.4/sqrt(40))
```

```{r}
1-0.7852
```

There's about a 21.48% chance that, in a sample of 40 women, their avg height is at least 64.3".

## Hyp Tests for mu

Suppose that, in a sample of 50 men at DU, their avg height is computed to be 69.7" and stdev = 3.2".  THIS IS **S**, NOT SIGMA!!

Does this provide statistically significant evidence the mean height of men at DU is higher than the national average of 69?


1) Hypotheses

H0: mu = 69
Ha: mu > 69

2)  Test statistic:

    z = (obs - exp)/stdev
      = (xbar - mu)/(sigma/sqrt(n))

Problem!  What's sigma?  Remember, the whole reason we're doing this hyp test is because we DON'T KNOW what the population parmeters are!  Definitely don't know mu, that's what we're here for. So, why would we know sigma?  WE DON'T!!

Oh no!  What to do??

Need to use the next best thing:  sample standard dev, s!

Ok, but there's another problem:

    (xbar - mu)/(s/sqrt(n))  DOESN'T follow a normal distribution!

The answer:  use a modified version of the normal distribution called the 

  **t distribution**!!
  
![](https://andyjconnelly.files.wordpress.com/2017/05/distributions1.png)  
  

Let's get to know "t" a little better.  Important properties:

 - looks just like the normal dist!  bell-shaped, and symmetric about 0.
 - importand difference:  the t dist has "thicker tails".  This has two consequences:
   - it makes our CIs wider, since we need to go further out to get the middle%
   - it makes p-vals bigger in Hyp Tests, since tail area is bigger!
  
These differences are a huge bummer!  CIs an Hyp Tests based on t are less good/successful.  However, we have be honest.  This is the price that we pay for not knowing the population standard deviation sigma!

Back to our test:

    t = (69.7-69)/(3.2/sqrt(50))
    
Here:

- xbar = 69.7 (observed mean)
- mu = 69 (expectation from the Null Hyp)
- s = 3.2 (std dev of our data)
- n = 50

```{r}
(69.7-69)/(3.2/sqrt(50))
```

WARNING:  the t-table is a arranged a little differently.  The specific shape of the t-dist depends on the sample. In order to use the table, need a sample size.  Here, we call this "degrees of freedom" or "df".

   df = n - 1 = 50-1
   
Our df = 49

3) P-val

From the t-table, our p-val (tail area) must be between .05 and .10.  

    .05 < p < .10
    
4)  Since p>.05, we FAIL to reject H0.  There's not strong evidence to support the claim that men at DU have mean height greater than 69".



### Summary of difference between proportions (categorical) and means (quant):

- for proportions, use the z table.  exp = p, stdev = sqrt(p(1-p)/n)

- for means, use the t table.  exp = mu, stdev = s/sqrt(n)





    

    
    
    



















































