---
title: "Math 120 Lec 06 "
author: "Ali Miller"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 3
    code_folding: show
    theme: simplex
    df_print: paged
  
---

```{r setup, include=FALSE}
###########################################################################
################# DON'T DELETE THIS PART!!!!!##############################
###########################################################################
                                                                          #
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)      #
                                                                          #
library(tidyverse)           #The tidyverse has all of our data tools     #
library(ggthemes)            #ggthemes makes our graphs look nicer        #
                                                                          # 
theme_set(                                #this sets the theme for all    #
  theme_tufte() +                         #plots that we make             #
  theme(text=element_text(family="sans"))                                 #
  )                                                                       #
                                                                          #
                                                                          #
                                                                          #
### Below is where you read and store your data.                          #
                                                                          #
youShouldRenameThis <- read_csv("death penalty data.csv")
                                                                          #
                                                                          #
                                                                          #
############# ^ ################################# ^ #######################
############# | ## DON'T DELETE THIS PART!!!!!### | #######################
############# | ################################# | #######################
```

## Reading Discussion: Linear Regression

##Intro to Correlation and Linear Regression


We start with a scatterplot, an x-y plot of two numerical variables.

### Examples: mpg data


```{r}

mpg %>% head


#examine rel btwn cty and hwy

qplot(x=cty, y=hwy, data=mpg)

```

One more:  displ vs cty.

```{r}


qplot(displ, cty, data=mpg, geom="point")
```




### Key qualities of a linear relationship

1) Form/shape.  Here in 120, we only do linear relationships.  But, there are many kinds:  exponential, logistic, polynomial, etc.  

2) Direction:  pos or neg.

In examples, the first cty vs hwy is positive.  Both go up together!  However, displ vs cty is a negative rel:  if displ gets bigger, cty gets smaller.


3) Strength.  In our examples, cty/hwy is stronger than displ/cty.

## Linear correlation coefficient r


Note: this little "r" is different from our big "R".  

The correl coefficient r measures the strength and direction of our relationship.

If r is close to 1, strong pos rel.

If r is close to -1, strong neg rel.

If r is close to zero, there's not a linear relationship.  

Warning!  r only describes linear relationships.  Ex on board:

##### Properties of r

-   -1 < r < 1    always!!!!!  (not possible to have r=1.3)
- doesn't matter which is x, which is y
- r doesn't depend on units (i.e. feet/meters)  (whew! don't have to worry about data units!!)






### Example: 8.8 on page 314

Identifying r in graphs.

## Least Squares Equation




### The equation

It's a line!  In high school, you wrote:

y = mx+b

In stats, we use different letters:

yhat = b_1 *x + b_0

b_1 is the slope (like m)

b_0 is the intercept (like b)

Exactly the same!


#### Example: mpg data

```{r}

# in R, we use lm for linear model.

# here's how to find equation for cty and hwy in mpg:



lm(hwy~cty, data=mpg)



mpg %>% head

```

Observations:  

- The ~ has a special meaning:  here, hwy is a function of cty.  Note that y comes first:  here, that's hwy fuel efficiency.
- I.e., we're predicting hwy based on cty.


Let's visualize:

```{r}

qplot(cty, hwy, data=mpg)+geom_smooth(method = "lm")

#what's R?  use cor()

cor(mpg$cty, mpg$hwy)

```

Challenge:  plot displ vs cty, find correlation coeff, and plot the line

```{r}
qplot(displ, cty, data=mpg)+geom_smooth(method="lm")

lm(cty ~ displ, data=mpg)

cor(mpg$cty, mpg$displ)
```


### Uniqueness

### Idea behind deriving it

### Using lm in R


### Making predictions

### Meaning of the coefficients

## Residuals

### Meaning (math and graphical)

### Example: mpg data

### Interpreting Residual Plots

##Effects of Outliers