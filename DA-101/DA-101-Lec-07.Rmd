---
title: "DA 101 Week 3"
author: "Prof Miller"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 3
    code_folding: show
    theme: cerulean
    df_print: paged
  
---

```{r setup, include=FALSE}

#---------- RSTUDIO STARTER V 2.0  --------------#
#                    -Prepared with care by  AM ;D
                
                                                                          
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE)      
library(tidyverse)                
library(ggthemes)                    

theme_set(theme_tufte() +                                     
  theme(text=element_text(family="sans")))  

#------------------------------------------------#
```



# Monday

## Linear regression warm-up

```{r}
houseData <- read_csv("House-Sales.csv")
head(houseData)
nrow(houseData)
```

Exercise:  use linear models to predict price based upon various factors.

For each group, you'll have a particular factor/variable.  Using this:

1)  Make a linear model.
2)  State the equation of the linear model
3) Carefully interpet the coefficients of the model.
4) Carefully interpret R^2, the coefficient of determination
5) Analyze the residuals.

Team 1:  Bedrooms

```{r}
model <- lm(data=houseData, price~bedrooms)
qplot(houseData$bedrooms, houseData$price)
summary(model)
```

SLope: for each additional bedroom a house has, we expect it's price to increase by $121,790.

R^2:  About 9.5% of the variation in price is due to the relationship between price and # of bedrooms.  

Team 2:  Bathrooms

```{r}
qplot(houseData$bathrooms, houseData$price)
summary(lm(data=houseData, price~bathrooms))
```
SLope: for each additional bathroom a house has, we expect/predict it's price to increase by $250,485.

R^2:  About 27.6% of variation in price is due to relationship between price and # of bathrooms.  
Team 3:  Sqft Living

```{r}
qplot(houseData$sqft_living, houseData$price)
sqftModel <- lm(data=houseData, price~sqft_living)
summary(sqftModel)
qplot(houseData$sqft_living, sqftModel$residuals)
```
Residuals:  highly heteroskedastic!!  Kidna bad!  Makes sense though, the model does a good job for "normal" sized houses on the left, but not for the very unusual (huge) on the right!

```{r}
qplot(sqftModel$residuals, geom="histogram")
boxplot(sqftModel$residuals, horizontal=TRUE)
```
Also, quite a bit of right skew in the residuals.  Some of these predictions have high error!  Kinda bad! 

Slope:  for every additional sqft, we expect the price to increase by $280.807.

R^2:  About 49.29% of the variation in price is because of the lin rel between price and sqft_living.  



Team 4:  FLoors

```{r}
qplot(houseData$floors, houseData$price)+geom_smooth(method="lm")+geom_jitter()

summary(lm(data=houseData, price~floors))
```


Team 5:  Year Built

```{r}
qplot(houseData$yr_built, houseData$price)+geom_smooth(method="lm")

summary(lm(data=houseData, price~yr_built))
```
Intersting observation:  one might wonder, are older houses or newer houses worth more in this market?  Seems like no!  Only about 0.2% of the variation in price is because of the year it was built.  

